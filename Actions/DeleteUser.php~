<?php
//Öppna anslutning till databas
include_once 'connection.php';

if(isset($_POST['submit'])){
//Hämta globala variabler från POST
$userNr = $_POST['user'];

//SQL för att ta bort användare

//Tar bort alla artiklar i ordrar relaterade till användaren
$sql = "DELETE ArticlesInOrder FROM `order` INNER JOIN ArticlesInOrder ON `order`.orderNr = ArticlesInOrder.orderNr WHERE `order`.orderNr = ArticlesInOrder.orderNr AND `order`.userNr = '$userNr'";
$stmt = $conn->prepare($sql);
$stmt->execute();

//Tar bort alla ordrar relaterade till användaren
$sql = "DELETE FROM `order` WHERE `order`.userNr = '$userNr'";
$stmt = $conn->prepare($sql);
$stmt->execute();

//Tar bort alla kommentarer relaterade till användaren
$sql = "DELETE FROM Comment WHERE userNr = '$userNr'";
$stmt = $conn->prepare($sql);
$stmt->execute();

//Tar bort användaren
$sql = "DELETE FROM User WHERE userNr = '$userNr'";
$stmt = $conn->prepare($sql);
$stmt->execute();

//Skicka tillbaka användaren
header("Location: ../kontohantering.php");
exit();

} else {
	header("Location: ../kontohantering.php");
	exit();
}
?>